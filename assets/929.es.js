"use strict";(self.webpackChunkregtool=self.webpackChunkregtool||[]).push([[929],{386:(e,l,s)=>{s.r(l),s.d(l,{Bingo:()=>y,BingoList:()=>O});var t=s(4246),o=s(7378),n=s(4764),i=s(6223),c=s(3395),a=s(5415),r=s(922),d=s(4794),u=s(3029),b=s(5622),g=s(6114),h=s(7663),j=s(82),x=s(2667),m=s(598),f=s(50);const v={bingo:"fEz5D",table:"XfOPd",textarea:"fLJto",buttons:"rWTB0",mode:"X-sFd",check:"Ym3Fv",checkGreen:"cG0vT",checkRed:"nmSBh",order:"npxBm",bottomPanel:"-pbtG",listElem:"LpZ2L"};var C=s(317),z=s(3302);function y(){var e,l;const s=(0,j.PD)("bingo"),{itemsModel:a,settingsModel:d}=s;(0,x.SZ)(a);const{current:u,currentData:g}=a,h=(0,o.useMemo)((()=>new b.z(Object.assign({table:{}},g))),[u,g]);(0,x.SZ)(h),(0,x.SZ)(h,(0,o.useCallback)((()=>a.editData(h.data)),[h]));const{columns:C,rows:z}=a.getCurrentItem(),{table:y,textStyle:S,cellStyle:P={},nameStyled:O}=h.data,[p,Z]=(0,o.useState)(!1);(0,x.SZ)(s.settingsModel,(0,o.useCallback)((()=>{Z(s.settingsModel.get("mode"))}),[]));const E=(0,o.useMemo)((()=>{var e;const l=[];for(let s=0;s<z;s++)for(let o=0;o<C;o++){const n=null===(e=null==y?void 0:y[s])||void 0===e?void 0:e[o],i=s*C+o+1,c=new b.z(n);l.push((0,t.jsx)(x.LE,Object.assign({callback:()=>{y[s]||(y[s]={}),y[s][o]=c.data,a.editData(h.data)},model:c},{children:(0,t.jsx)(k,{order:i,cell:c,mode:p,settings:h})}),u+"-"+s+"-"+o))}return(0,t.jsx)(t.Fragment,{children:l})}),[y,u,C,z,p]);return(0,t.jsx)(n.wv,Object.assign({className:v.bingo},{children:(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Hb,{current:u,model:a,defaultName:"bingo",style:O?{fontFamily:null==S?void 0:S.fontFamily,color:null==S?void 0:S.color,borderStyle:"solid",borderColor:null!==(e=P.borderColor)&&void 0!==e?e:"#000",borderWidth:void 0!==P.borderWidth?2*P.borderWidth:void 0,backgroundColor:P.backgroundColor}:void 0}),(0,t.jsx)("div",Object.assign({className:(0,f.cn)(v.table,p&&v.mode),style:Object.assign(Object.assign({},P),{fontFamily:null==S?void 0:S.fontFamily,color:null==S?void 0:S.color,fontSize:null==S?void 0:S.fontSize,gridTemplateColumns:`repeat(${C}, ${150+2*(null!==(l=P.borderWidth)&&void 0!==l?l:1)}px)`})},{children:E})),(0,t.jsxs)(n.gF,Object.assign({className:v.bottomPanel},{children:[(0,t.jsx)(i.zx,Object.assign({color:p?"orange":"blue",onClick:()=>d.set({mode:!p})},{children:p?"modo de edición":"modo de selección"})),(0,t.jsx)(i.zx,Object.assign({color:"green",onClick:()=>(0,m.mN)((e=>(0,t.jsxs)(r.hO,Object.assign({style:{maxWidth:400}},{children:[(0,t.jsx)(r.Cd,{children:"ajustes"}),(0,t.jsx)(A,{settings:h}),(0,t.jsx)(r.u2,{children:(0,t.jsx)(i.zx,Object.assign({color:"blue",onClick:e},{children:"cerrar"}))})]}))))},{children:"ajustes"}))]}))]})}))}function S(e,l=!1){if(l)return{maxWidth:"99%",maxHeight:"99%"};switch(e){case g.g$.Bottom:return{top:"31%"};case g.g$.Middle:return{top:"50%"};case g.g$.Top:return{top:"69%"}}}function k({order:e,cell:l,mode:s,settings:i}){var c,r;(0,x.SZ)(l);const{text:b,textStyle:j,cellStyle:y={},selected:k,image:A}=l.data,[P,O]=(0,o.useState)(0),[p,Z]=(0,o.useState)(),E=(0,o.useRef)(),M=(0,o.useRef)();(0,x.SZ)(i);const{textAlign:N,autoSize:w=!0,useCheckMark:W,orderStyle:D,displayOrder:L=!0,fullSizeImage:_}=i.data;(0,o.useLayoutEffect)((()=>{Z(w?+getComputedStyle(M.current).fontSize.match(/\d+/):void 0)}),[w]),(0,o.useLayoutEffect)((()=>{const e=E.current.offsetHeight,l=M.current.offsetHeight;N===g.g$.Bottom?O(l<e?0:l-e):N===g.g$.Top?O(0):O(l<e?0:l/2-e/2)}),[p,b,N]),(0,o.useLayoutEffect)((()=>{const{offsetHeight:e,offsetWidth:l}=E.current,s=M.current.offsetHeight,t=M.current.offsetWidth,o=Math.min(s/(e+20),t/(l+20));Z(w?e=>(0,f.uZ)(Math.round(e*o*2)/2,0,34):void 0)}),[b,w,N]);const[F,I]=(0,o.useState)(!1);return(0,t.jsxs)("div",Object.assign({className:(0,f.cn)(k&&v.selected),style:Object.assign({color:null==j?void 0:j.color},y),onClick:()=>s&&l.set({selected:!k})},{children:[A&&(0,t.jsx)(h.cu,{id:A,style:S(N,_)}),(0,t.jsx)(u.f,{className:v.textarea,contentEditable:!s,spellCheck:!1,inlineProps:{style:{backgroundColor:null!==(c=null==j?void 0:j.backgroundColor)&&void 0!==c?c:null===(r=i.data.textStyle)||void 0===r?void 0:r.backgroundColor}},style:{paddingTop:P,fontSize:p,overflow:w?"hidden":"auto"},content:b,onChange:e=>l.set({text:e}),refSpan:E,refDiv:M,onDrop:e=>(0,h.TV)(e,h.WD.Image).then((([[e]])=>l.set({image:e}))),onFocus:()=>I(!0),onBlur:()=>I(!1)}),(0,t.jsx)(d.hU,Object.assign({circle:!0,display:F,className:v.buttons,onClick:e=>(0,m.mN)((()=>(0,t.jsx)(m.e1,Object.assign({e},{children:(0,t.jsxs)(n.Lr,{children:[(0,t.jsx)(a.E,{value:null==y?void 0:y.backgroundColor,i:"background",onChange:e=>l.set({cellStyle:{backgroundColor:e}})}),(0,t.jsx)(a.E,{value:null==j?void 0:j.color,i:"font",onChange:e=>l.set({textStyle:{color:e}})}),(0,t.jsx)(a.E,{value:null==j?void 0:j.backgroundColor,i:"underline",onChange:e=>l.set({textStyle:{backgroundColor:e}})}),(0,t.jsx)(a.E,{value:null==y?void 0:y.borderColor,i:"border",onChange:e=>l.set({cellStyle:{borderColor:e}})}),(0,t.jsx)(d.hU,Object.assign({onClick:()=>(0,h.Pq)({selected:[A],category:h.WD.Image,count:1}).then((([e])=>l.set({image:e})))},{children:(0,t.jsx)(C.Z,{})}))]})}))))},{children:(0,t.jsx)(z.Z,{})})),s&&k&&(0,t.jsx)(d.YJ,{checked:W,className:(0,f.cn)(v.check,W?v.checkGreen:v.checkRed)}),L&&(0,t.jsx)("div",Object.assign({className:v.order,style:(0,g.OX)(D)},{children:e}))]}))}function A({settings:e}){var l;const s=(0,j.PD)("bingo").itemsModel,{currentData:o,current:c}=s,d=s.getCurrentItem();(0,x.SZ)(s),(0,x.SZ)(e);const{table:u,cellStyle:b,textStyle:h,displayOrder:m=!0,useCheckMark:v=!1,orderStyle:C,autoSize:z=!0,textAlign:y=g.g$.Middle,fullSizeImage:S=!1,nameStyled:k=!1}=e.data;return(0,t.jsx)(r.pP,{children:(0,t.jsxs)(n.sg,{children:[(0,t.jsx)(n.__,Object.assign({label:"número de columnas"},{children:(0,t.jsx)(i.Af,{min:1,max:20,value:d.columns,onChange:e=>s.editItem(c,{columns:e})})})),(0,t.jsx)(n.__,Object.assign({label:"número de filas"},{children:(0,t.jsx)(i.Af,{min:1,max:20,value:d.rows,onChange:e=>s.editItem(c,{rows:e})})})),(0,t.jsxs)(n.ZA,Object.assign({label:"general"},{children:[(0,t.jsx)(n.__,Object.assign({label:"imágenes de celda completa"},{children:(0,t.jsx)(i.XZ,{checked:S,onChange:l=>e.set({fullSizeImage:l})})})),(0,t.jsx)(n.__,Object.assign({label:"estilizar el título"},{children:(0,t.jsx)(i.XZ,{checked:k,onChange:l=>e.set({nameStyled:l})})}))]})),(0,t.jsx)(n.nA,Object.assign({label:"ordinal",checked:m,onChange:l=>e.set({displayOrder:l})},{children:(0,t.jsx)(P,{settings:e,fieldName:"orderStyle"})})),(0,t.jsx)(n.__,Object.assign({label:"marcar"},{children:(0,t.jsx)(i.XZ,{checked:v,onChange:l=>e.set({useCheckMark:l})})})),(0,t.jsx)(n.__,Object.assign({label:"tamaño automático"},{children:(0,t.jsx)(i.XZ,{checked:z,onChange:l=>e.set({autoSize:l})})})),(0,t.jsx)(n.ZA,Object.assign({label:"diseño del texto"},{children:(0,t.jsx)(P,{settings:e,fieldName:"textStyle"})})),(0,t.jsxs)(n.ZA,Object.assign({label:"diseño de celda"},{children:[(0,t.jsxs)(n.Lr,{children:[(0,t.jsx)(a.E,{value:null==b?void 0:b.backgroundColor,i:"background",onChange:l=>e.set({cellStyle:{backgroundColor:l}})}),(0,t.jsx)(a.E,{value:null==b?void 0:b.borderColor,i:"border",onChange:l=>e.set({cellStyle:{borderColor:l}})}),(0,t.jsx)(i.Af,{min:0,max:8,value:null!==(l=null==b?void 0:b.borderWidth)&&void 0!==l?l:1,onChange:l=>e.set({cellStyle:{borderWidth:l}})})]}),(0,t.jsx)(n.Lr,{children:(0,t.jsx)(g.Ve,{value:y,onChange:l=>e.set({textAlign:l})})})]})),(0,t.jsx)(i.zx,Object.assign({color:"red",onClick:()=>{const l=Object.entries(u).map((([e,l])=>[e,Object.entries(l).reduce(((e,[l,s])=>(null==s||delete s.textStyle,null==s||delete s.cellStyle,e[l]=s,e)),{})]));e.data.table=(0,f.ru)(l),e.notify()}},{children:"restablecer estilos de celda"}))]})})}function P({settings:e,fieldName:l}){(0,x.SZ)(e);const s=e.data[l];return(0,t.jsxs)(n.Lr,{children:[(0,t.jsx)(a.E,{value:null==s?void 0:s.color,i:"font",onChange:s=>e.set({[l]:{color:s}})}),(0,t.jsx)(a.E,{value:null==s?void 0:s.backgroundColor,i:"background",onChange:s=>e.set({[l]:{backgroundColor:s}})}),(0,t.jsx)(g.rs,{value:null==s?void 0:s.fontSize,onChange:s=>e.set({[l]:{fontSize:s}}),nullable:!0}),(0,t.jsx)(g.mi,{value:null==s?void 0:s.fontFamily,onChange:s=>e.set({[l]:{fontFamily:s}}),nullable:!0})]})}function O(){return(0,t.jsx)(c.sr,{model:(0,j.PD)("bingo").itemsModel,deleteButton:!0,renderItem:({name:e,rows:l,columns:s})=>(0,t.jsx)(p,{name:e||"bingo",columns:s,rows:l})})}function p({name:e,rows:l,columns:s}){return(0,t.jsxs)("div",Object.assign({className:v.listElem},{children:[(0,t.jsx)("div",{children:e}),(0,t.jsxs)("div",{children:[s," x ",l]})]}))}}}]);